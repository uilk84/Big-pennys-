<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Penny Scanner v4</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
body {
  background:#0b1220;
  color:#fff;
  font-family: Arial, sans-serif;
  padding:15px;
}
h1 { margin-bottom:10px; }
.controls {
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin-bottom:10px;
}
button,input,label {
  background:#1b2436;
  color:white;
  border:none;
  padding:8px 12px;
  border-radius:8px;
}
.card {
  background:#111a2b;
  border-left:6px solid #444;
  padding:12px;
  margin-bottom:12px;
  border-radius:12px;
}
.hot { border-color:#00ff9c; }
.warm { border-color:#ffc107; }
.watch { border-color:#4dabff; }
.status { font-weight:bold; }
a { color:#9ecbff; }
.progress {
  height:6px;
  background:#333;
  border-radius:6px;
  overflow:hidden;
  margin:10px 0;
}
.bar {
  height:100%;
  width:0%;
  background:#00d4ff;
}
</style>
</head>
<body>

<h1>ðŸ“ˆ Penny Scanner v4</h1>

<div class="controls">
<button onclick="toggleSound()">ðŸ”” Sound: <span id="soundStatus">ON</span></button>
<input id="minVol" type="number" value="100000" />
<label><input type="checkbox" id="showAll" checked /> Show All</label>
<label><input type="checkbox" id="prOnly" /> PR Only</label>
<button onclick="scan()">Scan Now</button>
</div>

<div id="status">Status: ready</div>
<div class="progress"><div id="bar" class="bar"></div></div>
<div id="leader"></div>

<div id="results"></div>

<audio id="beep" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

<script>
const API_KEY = "C3U8voH19zrxl5iCPHEDHSdOWgJwL6oi";
const FMP_URL = "https://financialmodelingprep.com/api/v3/stock_market/gainers?apikey=" + API_KEY;

let soundOn = true;
let progress = 0;

const demoData = [
 {symbol:"SMOVE", price:3.42, volume:800000, news:"SMOVE surges after press release"},
 {symbol:"TWG", price:5.11, volume:1200000, news:"TWG launches new product"},
 {symbol:"DRCT", price:2.95, volume:450000, news:"DRCT heavy volume after announcement"},
 {symbol:"TRUE", price:1.88, volume:250000, news:"TRUE reports earnings"}
];

function toggleSound(){
 soundOn = !soundOn;
 document.getElementById("soundStatus").innerText = soundOn ? "ON":"OFF";
}

async function scan(){
 progress=0;
 document.getElementById("bar").style.width="0%";
 document.getElementById("status").innerText="Scanning...";
 animateBar();

 let data=[];
 let used="LIVE";

 try{
   const res = await fetch(FMP_URL+"&t="+Date.now());
   if(!res.ok) throw new Error("HTTP "+res.status);
   data = await res.json();
 }catch(err){
   data = demoData;
   used="DEMO (API blocked)";
 }

 processData(data,used);
}

function animateBar(){
 if(progress>=100) return;
 progress+=5;
 document.getElementById("bar").style.width=progress+"%";
 setTimeout(animateBar,200);
}

function processData(data, used){
 const minVol = parseInt(document.getElementById("minVol").value);
 const showAll = document.getElementById("showAll").checked;
 const prOnly = document.getElementById("prOnly").checked;

 let filtered = data.filter(s => s.volume >= minVol);

 if(prOnly){
   filtered = filtered.filter(s => (s.news||"").toLowerCase().includes("press"));
 }

 if(!showAll){
   filtered = filtered.slice(0,5);
 }

 let leader = filtered.length ? filtered[0].symbol : "None";
 document.getElementById("leader").innerText="Leader: "+leader;
 document.getElementById("status").innerText="Used: "+used+" | "+filtered.length+" stocks";

 const box = document.getElementById("results");
 box.innerHTML="";

 filtered.forEach(stock=>{
   let status="WATCH", cls="watch";
   if(stock.volume>700000){ status="HOT"; cls="hot"; }
   else if(stock.volume>400000){ status="WARM"; cls="warm"; }

   const div=document.createElement("div");
   div.className="card "+cls;
   div.innerHTML=`
   <strong>${stock.symbol} $${stock.price || "?"}</strong><br>
   Vol: ${stock.volume}<br>
   ${stock.news || "No news"}<br>
   <span class="status">${status}</span><br>
   <a href="https://www.tradingview.com/symbols/${stock.symbol}/" target="_blank">ðŸ“Š Chart</a>
   `;
   box.appendChild(div);

   if(soundOn && status==="HOT"){
     document.getElementById("beep").play();
   }
 });

}

scan();
setInterval(scan,30000);
</script>

</body>
</html>
