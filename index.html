<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Penny Scanner v1 (Safe)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  background:#0b1220;
  color:#fff;
  font-family:system-ui;
  margin:0;
  padding:20px;
}
h1 {margin-bottom:10px;}
.controls {
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin-bottom:15px;
}
button,input {
  background:#1c2438;
  border:none;
  border-radius:8px;
  padding:10px;
  color:white;
  font-size:14px;
}
.stock {
  background:#111a2f;
  border-left:6px solid #facc15;
  padding:12px;
  margin-bottom:10px;
  border-radius:10px;
}
.hot { border-left-color:#22c55e; }
.warm { border-left-color:#facc15; }
.watch { border-left-color:#3b82f6; }
a {color:#60a5fa;}
.small {opacity:.7;font-size:13px;}
</style>
</head>

<body>
<h1>ðŸ“ˆ Penny Scanner v1 (Safe)</h1>

<div class="controls">
<button onclick="toggleSound()">ðŸ”” Sound: <span id="soundState">ON</span></button>
<input id="minVol" type="number" value="100000" placeholder="Min Volume">
<label><input type="checkbox" id="prOnly"> PR Only</label>
</div>

<div class="small" id="status">Loading...</div>
<div id="stocks"></div>

<audio id="beep" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

<script>
let soundOn=true;
let lastLeader="";

function toggleSound(){
 soundOn=!soundOn;
 document.getElementById("soundState").textContent=soundOn?"ON":"OFF";
}

async function fetchStocks(){
 const url="https://query1.finance.yahoo.com/v1/finance/screener/predefined/saved?count=25&scrIds=day_gainers";
 try{
  const res=await fetch(url);
  const data=await res.json();
  processStocks(data.finance.result[0].quotes);
 }catch(e){
  demoData();
 }
}

function processStocks(list){
 const minVol=parseInt(document.getElementById("minVol").value||0);
 const prOnly=document.getElementById("prOnly").checked;
 let out=[];
 list.forEach(s=>{
  if(!s.symbol || !s.regularMarketVolume) return;
  if(s.regularMarketVolume<minVol) return;
  let news=(s.longName||"")+" "+(s.shortName||"");
  let hasPR=/press|launch|contract|approval|merger|acquire/i.test(news);
  if(prOnly && !hasPR) return;
  out.push({
    sym:s.symbol,
    price:s.regularMarketPrice,
    vol:s.regularMarketVolume,
    news:news.substring(0,120),
    pr:hasPR
  });
 });

 render(out);
}

function render(list){
 const box=document.getElementById("stocks");
 box.innerHTML="";
 if(list.length==0){
   box.innerHTML="<div class='small'>No stocks match filters.</div>";
   return;
 }
 const leader=list[0].sym;
 document.getElementById("status").textContent="Leader: "+leader+" | Next scan in 30s";

 if(leader!==lastLeader && soundOn){
   document.getElementById("beep").play();
   lastLeader=leader;
 }

 list.forEach((s,i)=>{
  let status=i==0?"HOT":i<3?"WARM":"WATCH";
  let cls=status.toLowerCase();
  box.innerHTML+=`
  <div class="stock ${cls}">
   <b>${s.sym}</b> $${s.price}<br>
   Vol: ${s.vol.toLocaleString()}<br>
   <span class="small">${s.news}</span><br>
   <b>Status: ${status}</b><br>
   <a href="https://finance.yahoo.com/quote/${s.sym}" target="_blank">ðŸ“Š Chart</a>
  </div>`;
 });
}

function demoData(){
 render([
  {sym:"SMOVE",price:3.42,vol:800000,news:"SMOVE surges after press release"},
  {sym:"TWG",price:5.11,vol:1200000,news:"TWG launches new product"},
  {sym:"DRCT",price:2.95,vol:450000,news:"DRCT heavy volume after announcement"},
  {sym:"TRUE",price:1.88,vol:250000,news:"TRUE reports earnings"}
 ]);
 document.getElementById("status").textContent="Demo mode (Yahoo blocked)";
}

fetchStocks();
setInterval(fetchStocks,30000);
</script>
</body>
</html>
