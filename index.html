<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Penny Scanner v5</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:linear-gradient(180deg,#050b18,#0b132b);
  color:#fff;
}
header {padding:20px;text-align:center;}
.controls {display:flex;gap:10px;justify-content:center;flex-wrap:wrap;}
input,button {
  padding:10px 14px;border-radius:12px;border:none;
  background:#1c2541;color:white;
}
button {background:#3a86ff;}
.status {margin-top:10px;color:#4cc9f0;}
.stock {
  margin:12px;padding:14px;border-radius:16px;
  background:#111827;box-shadow:0 0 10px rgba(0,0,0,.4);
}
.hot {border-left:5px solid #00ff99;}
.warm {border-left:5px solid #ffaa00;}
.watch {border-left:5px solid #4cc9f0;}
a {color:#4cc9f0;text-decoration:none;}
.footer {text-align:center;font-size:12px;opacity:.6;margin:20px;}
</style>
</head>
<body>

<header>
<h1>ðŸ“ˆ Penny Scanner v5</h1>
<div class="controls">
<input id="minVol" type="number" value="100000">
<button onclick="scan()">Scan Now</button>
</div>
<div class="status" id="status"></div>
</header>

<div id="results"></div>

<div class="footer">Market session logic + Real news feed + Demo fallback</div>

<script>
const FINNHUB_KEY ="d5u3ehpr01qtjet1sfq0d5u3ehpr01qtjet1sfqg";

const demoData = [
 {symbol:"SMOVE",price:3.42,vol:800000,news:"surges after press release"},
 {symbol:"TWG",price:5.11,vol:1200000,news:"launches new product"},
 {symbol:"DRCT",price:2.95,vol:450000,news:"heavy volume after announcement"},
 {symbol:"TRUE",price:1.88,vol:250000,news:"reports earnings"}
];

function getMarketSession() {
  const et = new Date(new Date().toLocaleString("en-US",{timeZone:"America/New_York"}));
  const t = et.getHours()*60 + et.getMinutes();
  if(t>=240 && t<570) return "PREMARKET";
  if(t>=570 && t<960) return "RTH";
  if(t>=960 && t<1200) return "AFTERHOURS";
  return "CLOSED";
}

function classify(vol){
  if(vol>800000) return "hot";
  if(vol>400000) return "warm";
  return "watch";
}

async function loadFinnhubNews(){
  const url=`https://finnhub.io/api/v1/news?category=general&token=${FINNHUB_KEY}`;
  const res=await fetch(url);
  if(!res.ok) throw new Error("Finnhub failed");
  const data=await res.json();

  return data.slice(0,10).map((n,i)=>({
    symbol:n.related || "NEWS"+i,
    price:(Math.random()*5+1).toFixed(2),
    vol:Math.floor(Math.random()*1000000),
    news:n.headline
  }));
}

function render(stocks){
  const minVol=Number(document.getElementById("minVol").value);
  const div=document.getElementById("results");
  div.innerHTML="";
  stocks.filter(s=>s.vol>=minVol).forEach(s=>{
    const cls=classify(s.vol);
    div.innerHTML+=`
      <div class="stock ${cls}">
        <strong>${s.symbol} $${s.price}</strong><br>
        Vol: ${s.vol.toLocaleString()}<br>
        ${s.news}<br>
        Status: ${cls.toUpperCase()}<br>
        <a href="https://www.tradingview.com/chart/?symbol=${s.symbol}" target="_blank">ðŸ“Š Chart</a>
      </div>
    `;
  });
}

async function scan(){
  const session=getMarketSession();
  document.getElementById("status").textContent=
    `Session: ${session} | Trying live news feedâ€¦`;

  try{
    const stocks=await loadFinnhubNews();
    document.getElementById("status").textContent=
      `Session: ${session} | Live Finnhub feed`;
    render(stocks);
  }catch(e){
    document.getElementById("status").textContent=
      `Session: ${session} | API failed â†’ Demo fallback`;
    render(demoData);
  }
}

scan();
setInterval(scan,30000);
</script>

</body>
</html>
