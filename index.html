<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Penny Scanner v4</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
  margin:0;
  font-family: system-ui, sans-serif;
  background:#050b18;
  color:#fff;
}
header {
  padding:15px;
  text-align:center;
}
.controls {
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  justify-content:center;
  margin-bottom:10px;
}
button,input {
  padding:10px 14px;
  border-radius:10px;
  border:none;
  font-size:15px;
}
button {
  background:#1f2a44;
  color:#fff;
}
input {
  background:#0e172b;
  color:#fff;
}
.card {
  background:#0e172b;
  margin:12px;
  padding:14px;
  border-radius:14px;
  box-shadow:0 0 10px rgba(0,0,0,.4);
}
.hot { border-left:6px solid #00ff99; }
.warm { border-left:6px solid #ffcc00; }
.watch { border-left:6px solid #66aaff; }
a { color:#5ac8fa; text-decoration:none; }
small { color:#aaa; }
#leader { color:#00ff99; margin-top:5px; }
</style>
</head>
<body>

<header>
<h1>ðŸ“ˆ Penny Scanner v4</h1>

<div class="controls">
<input id="minVol" type="number" value="100000" placeholder="Min Volume">
<button onclick="scan()">Scan Now</button>
</div>

<div id="status">Ready</div>
<div id="leader"></div>
</header>

<div id="results"></div>

<script>
const API_KEY = "d5u2juhr01qtjet1q0tgd5u2juhr01qtjet1q0u0";

let lastLeader = "";

async function scan(){
  document.getElementById("status").innerText = "Scanning...";
  document.getElementById("results").innerHTML = "";
  document.getElementById("leader").innerText = "";

  try{
    // Get US symbols
    const symbolsRes = await fetch(`https://finnhub.io/api/v1/stock/symbol?exchange=US&token=${API_KEY}`);
    const symbols = await symbolsRes.json();

    let stocks = [];

    for(let i=0;i<40;i++){
      const sym = symbols[i].symbol;
      try{
        const quoteRes = await fetch(`https://finnhub.io/api/v1/quote?symbol=${sym}&token=${API_KEY}`);
        const q = await quoteRes.json();

        if(q.v && q.c){
          stocks.push({
            symbol: sym,
            price: q.c,
            volume: q.v,
            change: q.dp
          });
        }
      } catch(e){}
    }

    processStocks(stocks);

  } catch(e){
    document.getElementById("status").innerText = "API Error â€“ check your key";
  }
}

function processStocks(list){
  const minVol = parseInt(document.getElementById("minVol").value);

  let filtered = list.filter(s => s.volume >= minVol);

  filtered.sort((a,b)=> b.volume - a.volume);

  if(filtered.length === 0){
    document.getElementById("status").innerText = "No stocks found";
    return;
  }

  const leader = filtered[0].symbol;
  document.getElementById("leader").innerText = "Leader: " + leader;

  if(leader !== lastLeader){
    navigator.vibrate?.(200);
    lastLeader = leader;
  }

  document.getElementById("status").innerText = `Found ${filtered.length} stocks`;

  filtered.slice(0,10).forEach(stock=>{
    let status="WATCH";
    let cls="watch";

    if(stock.change > 5){
      status="HOT";
      cls="hot";
    } else if(stock.change > 2){
      status="WARM";
      cls="warm";
    }

    const div = document.createElement("div");
    div.className = `card ${cls}`;
    div.innerHTML = `
      <h3>${stock.symbol} $${stock.price.toFixed(2)}</h3>
      <small>Vol: ${stock.volume.toLocaleString()}</small><br>
      Change: ${stock.change?.toFixed(2)}%<br>
      Status: <b>${status}</b><br>
      <a target="_blank" href="https://www.tradingview.com/symbols/${stock.symbol}/">ðŸ“Š Chart</a>
    `;
    document.getElementById("results").appendChild(div);
  });
}

// auto scan every 30s
scan();
setInterval(scan,30000);
</script>

</body>
</html>
